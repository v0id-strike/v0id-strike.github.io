<h2>Why OPNsense?</h2>
<p>In the realm of digital warfare, OPNsense stands as a formidable sentinel, balancing security, flexibility, and open-source freedom. It grants you the power to command your network, fortify your defenses, and orchestrate traffic with precisionâ€”an essential stronghold for any cybersecurity practitioner.</p>
<ul>
<li>Download the ISO from <a href="https://opnsense.org/">OPNsense.org</a></li>
</ul>
<hr>
<h2>ğŸ“Œ Phase 1: Setting Up the OPNsense</h2>
<h3>Install OPNsense</h3>
<ol>
<li>Attach the OPNsense <strong>ISO</strong> to the machine and start it.</li>
<li>Login to live boot:
<ul>
<li><strong>Username:</strong> <code>installer</code></li>
<li><strong>Password:</strong> <code>opnsense</code></li>
</ul>
</li>
<li>Select keyboard layout.</li>
<li>Choose <strong>ZFS (Recommended for reliability)</strong>.</li>
<li>Select <strong>Stripe</strong> (Single Disk).</li>
<li>Choose the installation disk and confirm wipe.</li>
<li>Once installed, <strong>remove the ISO</strong> and reboot.</li>
</ol>
<hr>
<h2>ğŸ“Œ Phase 2: Initial Configuration</h2>
<h3>Assign Network Interfaces</h3>
<ol>
<li>Login: <strong>root / opnsense</strong></li>
<li>Select <strong>Option 1: Assign Interfaces</strong>
<ul>
<li><strong>WAN</strong> â†’ <code>em0</code></li>
<li><strong>LAN</strong> â†’ <code>em1</code></li>
<li><strong>DMZ</strong> â†’ <code>em2</code></li>
</ul>
</li>
</ol>
<h3>Configure LAN &amp; DMZ IPs</h3>
<ol>
<li>Select <strong>Option 2: Set Interface IP</strong>
<ul>
<li><strong>LAN (em1):</strong>
<ul>
<li>IP: <code>192.168.56.2/24</code></li>
<li>No Gateway</li>
<li>Enable DHCP: <strong>Yes</strong> (<code>192.168.56.10 - 200</code>)</li>
</ul>
</li>
<li><strong>DMZ (em2):</strong>
<ul>
<li>IP: <code>192.168.57.1/24</code></li>
<li>No Gateway</li>
<li>Enable DHCP: <strong>Yes</strong> (<code>192.168.57.10 - 200</code>)</li>
</ul>
</li>
</ul>
</li>
<li>Run <strong>Option 12: System Update</strong>.</li>
</ol>
<hr>
<h2>ğŸ“Œ Phase 3: Configuring Firewall &amp; NAT</h2>
<h3>Access OPNsense Web GUI</h3>
<ol>
<li>Open a browser.</li>
<li>Go to: <code>http://192.168.56.2</code></li>
<li>Login: <strong>root / opnsense</strong></li>
<li>Complete the setup wizard.</li>
<li>Rename <strong>OPT1</strong> to <strong>DMZ</strong> under <strong>Interfaces</strong>.</li>
</ol>
<h3>Enable NAT for Internet Access</h3>
<ol>
<li>Go to <strong>Firewall &gt; NAT &gt; Outbound</strong>.</li>
<li>Select <strong>Manual Mode</strong>.</li>
<li>Create a <strong>first rule</strong>:
<ul>
<li><strong>Interface:</strong> WAN</li>
<li><strong>Source Address:</strong> LAN Net</li>
<li><strong>Destination:</strong> Any</li>
<li><strong>Translation:</strong> Interface Address</li>
<li><strong>Description:</strong> <code>&quot;Allow LAN Internet Access&quot;</code></li>
</ul>
</li>
<li>Click <strong>Apply Changes</strong>.</li>
</ol>
<h3>Configure Firewall Rules</h3>
<h4>ğŸ›¡ï¸ DMZ Rules (Firewall &gt; Rules &gt; DMZ)</h4>
<p>âœ… <strong>Allow DMZ to Access Internet</strong></p>
<ul>
<li>Action: <strong>Pass</strong></li>
<li>Protocol: <strong>Any</strong></li>
<li>Source: <strong>DMZ Net</strong></li>
<li>Destination: <strong>WAN Net</strong></li>
<li>Click <strong>Apply Changes</strong></li>
</ul>
<p>ğŸš« <strong>Block DMZ from Accessing LAN</strong></p>
<ul>
<li>Action: <strong>Block</strong></li>
<li>Protocol: <strong>Any</strong></li>
<li>Source: <strong>DMZ Net</strong></li>
<li>Destination: <strong>LAN Net</strong></li>
<li>Click <strong>Apply Changes</strong></li>
</ul>
<h4>ğŸ›¡ï¸ LAN Rules (Firewall &gt; Rules &gt; LAN)</h4>
<p>âœ… <strong>Allow LAN to Any Rule</strong></p>
<ul>
<li>Action: <strong>Pass</strong></li>
<li>Protocol: <strong>Any</strong></li>
<li>Source: <strong>LAN Net</strong></li>
<li>Destination: <strong>Any</strong></li>
<li>Click <strong>Apply Changes</strong></li>
</ul>
<hr>
<h2>ğŸ“Œ Phase 4: Testing &amp; Monitoring</h2>
<h3>Verify Network Connectivity</h3>
<p>âœ… Check if connected devices receive an IP from DHCP.<br>
âœ… Test <strong>Internet access</strong> from LAN &amp; DMZ.<br>
âœ… Ping <strong>LAN from DMZ</strong> (should be blocked).<br>
âœ… Access a <strong>DMZ web server from LAN</strong> (should work).</p>
<h3>Monitor Firewall &amp; Logs</h3>
<ol>
<li>Go to <strong>Firewall &gt; Log Files &gt; Live View</strong>.</li>
<li>Look for blocked connections.</li>
<li>Check <strong>Interface Traffic Graphs</strong> for bandwidth usage.</li>
</ol>
<hr>
<h2>ğŸ“Œ Phase 5: Advanced Security Features</h2>
<h3>ğŸ” Intrusion Detection (Suricata)</h3>
<ol>
<li>Go to <strong>Services &gt; Intrusion Detection</strong>.</li>
<li>Enable <strong>IDS/IPS on WAN and LAN</strong>.</li>
<li>Download <strong>ET Open Ruleset</strong>.</li>
</ol>
<h3>ğŸ›¡ï¸ VPN Access (WireGuard)</h3>
<ol>
<li>Go to <strong>Services &gt; WireGuard</strong>.</li>
<li>Add a <strong>Local Endpoint</strong> (your OPNsense).</li>
<li>Add <strong>Peers</strong> (remote devices).</li>
<li>Assign to <strong>LAN Interface</strong>.</li>
<li>Connect securely from anywhere.</li>
</ol>
<h3>ğŸš¨ Port Forwarding (Exposing Services)</h3>
<ol>
<li>Go to <strong>Firewall &gt; NAT &gt; Port Forward</strong>.</li>
<li>Example: <strong>Expose a DMZ Web Server</strong>
<ul>
<li><strong>Interface:</strong> WAN</li>
<li><strong>Destination:</strong> WAN Address</li>
<li><strong>Port:</strong> <code>8080 â†’ 192.168.57.100:80</code></li>
<li>Apply changes.</li>
</ul>
</li>
<li>Test access from outside.</li>
</ol>
<hr>
<h2>ğŸ“Œ Phase 6: Backup, Updates &amp; High Availability</h2>
<h3><strong>ğŸ› ï¸ System Maintenance</strong></h3>
<p>âœ… <strong>Regular Firmware Updates</strong> (System &gt; Firmware).<br>
âœ… <strong>Automated Backups</strong> (System &gt; Configuration &gt; Backup).<br>
âœ… <strong>High Availability (HA)</strong> (System &gt; High Availability) to sync two OPNsense firewalls.</p>
